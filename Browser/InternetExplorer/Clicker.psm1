#---------------------------------------------------------------------------------------------------------------------
# Description
#---------------------------------------------------------------------------------------------------------------------
<#
	Author: Nilesh Mali
	Created Date: 25th Oct 2017
	Updated Date: 25th Oct 2017
	Desc: A module to represent Browser Download handler
#>

#---------------------------------------------------------------------------------------------------------------------
# Modules import section
#---------------------------------------------------------------------------------------------------------------------
$cwd = Split-Path -Path $MyInvocation.MyCommand.Definition -Parent
#Import-Module $cwd"\InternetExplorer.psm1"

#---------------------------------------------------------------------------------------------------------------------
# Class Definition with Data Members
#---------------------------------------------------------------------------------------------------------------------
$Clicker = New-Object PsObject -Property @{
	x = $true
}

#---------------------------------------------------------------------------------------------------------------------
# A Constructor
#---------------------------------------------------------------------------------------------------------------------
Function Clicker {
	$clicker = $Clicker.PsObject.Copy()
	$clicker
}

#---------------------------------------------------------------------------------------------------------------------
# Member Functions
#---------------------------------------------------------------------------------------------------------------------

#---------------------------------------------------------------------------------------------------------------------
$Clicker | Add-Member -MemberType ScriptMethod -Name "Save" -Value {
	write-host "Save"
}

#---------------------------------------------------------------------------------------------------------------------
$Clicker | Add-Member -MemberType ScriptMethod -Name "SaveAs" -Value {
	write-host "SaveAs"
}

#---------------------------------------------------------------------------------------------------------------------
$Clicker | Add-Member -MemberType ScriptMethod -Name "Open" -Value {
	write-host "Open"
}

#---------------------------------------------------------------------------------------------------------------------
$Clicker | Add-Member -MemberType ScriptMethod -Name "Run" -Value {
	write-host "Run"
}

#---------------------------------------------------------------------------------------------------------------------
$Clicker | Add-Member -MemberType ScriptMethod -Name "Cancel" -Value {
	write-host "Cancel"
}

#---------------------------------------------------------------------------------------------------------------------
$Clicker | Add-Member -MemberType ScriptMethod -Name "Activate" -Value {
	param( [Parameter(Mandatory=$true)][String] $actionsSequence = 120 )
	for($i=0; $i -lt $actionsSequence.length; $i++)
	{
		switch( $actionsSequence[$i] ) {
			1 {
				$this.Save()
				break
			}
			2 {
				$this.SaveAs()
				break
			}
			3 {
				$this.Open()
				break
			}
			4 {
				$this.Run()
				break
			}
			5 {
				$this.Cancel()
				break
			}
		} 
	}
}

#---------------------------------------------------------------------------------------------------------------------
